{"check_id": "rules.echoed-request", "end": {"col": 222, "line": 18, "offset": 663}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "$category", "location": {"end": {"col": 11, "line": 8, "offset": 200}, "path": "/home/kali/Desktop/semgrep_work/CVWA/site/filter.php", "start": {"col": 2, "line": 8, "offset": 191}}}], "taint_sink": ["CliLoc", [{"end": {"col": 222, "line": 18, "offset": 663}, "path": "/home/kali/Desktop/semgrep_work/CVWA/site/filter.php", "start": {"col": 5, "line": 18, "offset": 446}}, "echo \"<br><br>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\".addslashes($category).\" and STATUS = 'Ativo'' at line 1.<br><br>\";"]], "taint_source": ["CliLoc", [{"end": {"col": 18, "line": 8, "offset": 207}, "path": "/home/kali/Desktop/semgrep_work/CVWA/site/filter.php", "start": {"col": 13, "line": 8, "offset": 202}}, "$_GET"]]}, "engine_kind": "OSS", "fingerprint": "2f8272c160555cfa013580872089b43994b90b6463a024a44612cf5a18bca62e6ac97a2b67a516645069ca4c76e5e888d4eb7cdf49a6a8e2e195a3de0812eaaf_0", "fix": "echo htmlentities(\"<br><br>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\".addslashes($category).\" and STATUS = 'Ativo'' at line 1.<br><br>\");", "is_ignored": false, "lines": "\t\t\t\techo \"<br><br>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\".addslashes($category).\" and STATUS = 'Ativo'' at line 1.<br><br>\";", "message": "`Echo`ing user input risks cross-site scripting vulnerability. You should use `htmlentities()` when showing data to users.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://www.php.net/manual/en/function.htmlentities.php", "https://www.php.net/manual/en/reserved.variables.request.php", "https://www.php.net/manual/en/reserved.variables.post.php", "https://www.php.net/manual/en/reserved.variables.get.php", "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"], "subcategory": ["vuln"], "technology": ["php"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$...VARS": {"abstract_content": "\"<br><br>You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\".addslashes($category).\" and STATUS = 'Ativo'' at line 1.<br><br>\"", "end": {"col": 221, "line": 18, "offset": 662}, "start": {"col": 10, "line": 18, "offset": 451}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/home/kali/Desktop/semgrep_work/CVWA/site/filter.php", "start": {"col": 5, "line": 18, "offset": 446}}
{"check_id": "rules.echoed-request", "end": {"col": 38, "line": 15, "offset": 461}, "extra": {"dataflow_trace": {"intermediate_vars": [{"content": "$search", "location": {"end": {"col": 16, "line": 5, "offset": 163}, "path": "/home/kali/Desktop/semgrep_work/CVWA/site/search.php", "start": {"col": 9, "line": 5, "offset": 156}}}], "taint_sink": ["CliLoc", [{"end": {"col": 38, "line": 15, "offset": 461}, "path": "/home/kali/Desktop/semgrep_work/CVWA/site/search.php", "start": {"col": 5, "line": 15, "offset": 428}}, "echo \"You searched for: $search\";"]], "taint_source": ["CliLoc", [{"end": {"col": 49, "line": 5, "offset": 196}, "path": "/home/kali/Desktop/semgrep_work/CVWA/site/search.php", "start": {"col": 44, "line": 5, "offset": 191}}, "$_GET"]]}, "engine_kind": "OSS", "fingerprint": "0ba11ffa7884c1e5749a08e5af596bd190760e82dc0450a1d97c81214dc798321f223487552fd05b5a9850847a90ee574f495418d127c9cbd67c9e34ebd8ad3f_0", "fix": "echo htmlentities(\"You searched for: $search\");", "is_ignored": false, "lines": "\t\t\t\techo \"You searched for: $search\";", "message": "`Echo`ing user input risks cross-site scripting vulnerability. You should use `htmlentities()` when showing data to users.", "metadata": {"category": "security", "confidence": "MEDIUM", "cwe": ["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"], "cwe2021-top25": true, "cwe2022-top25": true, "impact": "MEDIUM", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "MEDIUM", "owasp": ["A07:2017 - Cross-Site Scripting (XSS)", "A03:2021 - Injection"], "references": ["https://www.php.net/manual/en/function.htmlentities.php", "https://www.php.net/manual/en/reserved.variables.request.php", "https://www.php.net/manual/en/reserved.variables.post.php", "https://www.php.net/manual/en/reserved.variables.get.php", "https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html"], "subcategory": ["vuln"], "technology": ["php"], "vulnerability_class": ["Cross-Site-Scripting (XSS)"]}, "metavars": {"$...VARS": {"abstract_content": "\"\"You searched for: $search\"", "end": {"col": 37, "line": 15, "offset": 460}, "start": {"col": 10, "line": 15, "offset": 433}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "/home/kali/Desktop/semgrep_work/CVWA/site/search.php", "start": {"col": 5, "line": 15, "offset": 428}}
